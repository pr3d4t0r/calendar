# - type: serial
#   steps:
#     - name: build
#       service: calendar
#       command: echo 'build'
- type: serial
  exclude: master
  steps:
    - name: ecs_push_latest
      service: calendar
      type: push
      image_tag: latest
      image_name: 233568328593.dkr.ecr.us-west-2.amazonaws.com/calendar
      registry: https://233568328593.dkr.ecr.us-west-2.amazonaws.com
      dockercfg_service: dockercfg_generator
- type: serial
  tag: master
  steps:
    - name: ecs_push_master
      service: calendar
      type: push
      image_tag: '{{.Branch}}'
      image_name: 233568328593.dkr.ecr.us-west-2.amazonaws.com/calendar
      registry: https://233568328593.dkr.ecr.us-west-2.amazonaws.com
      dockercfg_service: dockercfg_generator
- type: serial
  exclude: master
  steps:
    - name: deploy to staging
      service: ecsdeploy
      command: -c athleteone-staging -n calendar -t 300 -i 233568328593.dkr.ecr.us-west-2.amazonaws.com/calendar:latest
- type: serial
  tag: master
  steps:
    - name: deploy to production
      service: ecsdeploy
      command: -c athleteone-production -n calendar -t 300 -e CI_BRANCH -i 233568328593.dkr.ecr.us-west-2.amazonaws.com/calendar
